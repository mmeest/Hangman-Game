<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hangman</title>
    <style>
        *{
            /* background-color: rgb(201, 164, 119); */
            font-family: Arial, Helvetica, sans-serif;
            font-size: xx-large;
            font-weight: 700;
            text-transform: uppercase;
            text-shadow: 1px 1px 2px #9191c2;
        }        
        html{
            height: 100%;   /* for background not to repeat */
        }
        body{
            background-image: radial-gradient(rgb(245, 236, 218), rgb(94, 58, 14));
        }
        canvas{
            background-color: rgb(229, 196, 151);
            box-shadow: 10px 10px 5px #644b4b;
            border: 3px solid rgb(52, 52, 59);
            border-radius: 30px;
            background-image: radial-gradient(rgb(247, 227, 199), rgb(229, 196, 151));
            margin-left: 35%;
        }
        button{
            background-color:rgb(209, 235, 245);
            background-image: radial-gradient(rgb(245, 230, 209), rgb(209, 168, 109));
            box-shadow: 7px 7px 4px #524545;
            border-radius: 10px;
            border-radius: 30px;
            padding: 10px;
            padding-right: 15px;
            padding-left: 15px;
            margin: 5px;
        }
        input{
            border-radius: 30px;
            padding: 7px;
            box-shadow: 4px 4px 3px #644b4b inset;
        }
        .label, button{
            color: rgb(11, 11, 116);
        }
        .textBox{
            width: 30%;
            background-color:rgb(187, 51, 51);
            background-image: linear-gradient(to bottom right, antiquewhite , rgb(206, 166, 118));
            border-radius: 9px;
            padding-left: 12px;
            padding-top: 6px;
            padding-bottom: 6px;
            border-style: solid none solid solid;
            border-color: rgb(52, 52, 59);
            border-width: 1px;
            box-shadow: 4px 4px 3px #644b4b inset;
            text-shadow: 3px 3px 2px #b49696;
        }
        #title{
            margin-bottom: -120px;
            padding: -20px;
        }
        #word{
            padding-top: 5px;
            padding-bottom: 5px;
        }
        #userInput{
            text-align: center;
            background-color: antiquewhite;
        }
        #messages{
            text-align: center;
        }
        #solution, #answer{
            visibility: hidden;
        }
        #guessLabel{
            padding: 20px;
        }

    </style>
    
</head>
<body>
    <table border="0" width="100%">
        <tr id="title">
            <td colspan="2">
            <p align="center">Hangman</td>
        </tr>
        <tr>
            <td width="240px">
                <canvas id="myCanvas" width="200" height="300"></canvas>
            </td>
            <td>
                <table border="0" width="85%">
                    <tr>
                        <td width="30%" align="right" class="label">Word:</td>
                        <td width="50%" id="word" class="textBox">_ _ _ _ _ _ _ _ _ _</td>
                    </tr>
                    <tr>
                        <td width="30%" align="right" class="label">
                            <button type="button" onClick="solution();" id="solution">Solution:</button></td>
                        <td width="50%" id="answer" class="textBox">
                        </td>
                    </tr>
                    <tr>
                        <td width="30%" align="right" class="label" id="guessLabel">Guess:</td>
                        <td width="50%" id="guess">
                            <input type="text" id="userInput" maxlength="1" size="1" autocomplete="off" autofocus>
                            <button type="button" onclick="testLetter()" id="okButton">OK</button>
                            <!-- <button type="button" onClick="window.location.reload();" id="nG" style = "visibility:hidden">New Game</button> -->
                        </td>
                    </tr>
                    <tr>
                        <td width="30%" align="right" class="label">Guessed:</td>
                        <td width="50%" id="miss" class="textBox"></td>
                    </tr>
                    <tr>
                        <td width="30%" align="right" class="label">Left:</td>
                        <td width="50%" id="left" class="textBox">7</td>
                    </tr>  
                    <tr>
                        <td width="30%" align="right" class="label">Points:</td>
                        <td width="50%" id="points" class="textBox">0 / 100</td>
                    </tr>               
                    <tr>
                        <td width="30%" align="right" class="label"></td>
                        <td width="50%" id="newGame">
                        <button type="button" onClick="window.location.reload();" id="newGame">New Game</button></td>
                    </tr>
                </table>
            </td>
        </tr>
        <tr>
            <td colspan="2" id="messages">Guess a letter in the word!
            <p align="center"></td>
        </tr>
    </table>

    <script>
        var c = document.getElementById("myCanvas");
        var ctx  = c.getContext("2d");

        var points = 10;
        var totalPoints = 0;

        var guessNumber = 0;    
        var wrongGuesses = 0;   // for drawing
        var emptyWord = "__________";
        var printout = "";
        var alphabet = ["A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", 
            "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V", "W", "X", "Y", "Z"];
        var englishAlphabet = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
        var missedLetters = [];
        var guessedLetters = "";
        var words = ["absolutely", "accessible", "activities", "additional", "affordable", "apparently", "appearance",
            "background", "basketball", "candidates", "categories", "challenges", "collection", "commission", "commitment",
            "comparsion", "completely", "conference", "connection", "consistent", "contribute", "conversion", "definition",
            "department", "depression", "determined", "developing", "difference", "discussion", "efficency", "electrical",
            "electronic", "enterprise", "evaluation", "foundation", "frequently", "functional", "generation", "historical",
            "identified", "importance", "impossible", "impressive", "increasing", "incredible", "individual", "industrial",
            "innovative", "interested", "investment", "leadership", "literature", "medication", "membership", "originally",
            "percentage", "performing", "personally", "population", "prevention", "previously", "production", "protection",
            "reasonable", "recognized", "regardless", "relatively", "represents", "resolution", "restaurant", "scientific",
            "specialist", "statistics", "strategies", "successful", "supporting", "techniques", "technology", "television",
            "transition", "ultimately", "understand", "university", "vegetables"];

        var word = words[Math.floor(Math.random()*words.length)];
        word = word.toUpperCase();
        console.log(word);

        // use Enter key on text input to play 
        var input = document.getElementById("userInput");
        input.addEventListener("keyup", function(event) {
            if (event.keyCode === 13) {
                event.preventDefault();
                document.getElementById("okButton").click();
            }
        });

        // spacebar for page reload
        /* var input = document.getElementById("userInput");
        input.addEventListener("keyup", function(event) {
            if (event.keyCode === 32) {
                event.preventDefault();
                document.getElementById("nG").click();
            }
        }); */
        
        var userChar = "";
        function testLetter(){
            var userChar = document.getElementById("userInput").value.toUpperCase();
            console.log(userChar);
            document.getElementById('userInput').value = "";
            document.getElementById("userInput").focus();

            if(userChar == "" || userChar == " "){
                document.getElementById("messages").innerHTML = "Insert Character!";
            } else if(!(englishAlphabet.includes(userChar))){
                document.getElementById("messages").innerHTML = "Illegal Character!";
            } else if (guessedLetters.includes(userChar)){
                if(totalPoints >= 2){
                    totalPoints -= 2;
                } else if(totalPoints > 0) {
                    totalPoints = 0;
                }
                document.getElementById("points").innerHTML = totalPoints + " / 100";
                document.getElementById("messages").innerHTML = "Already Selected!";
            } else if (word.includes(userChar)){
                for (var i = 0; i < word.length; i++) {
                    console.log(word.charAt(i));
                    if(word.charAt(i) == userChar){
                        console.log("jehhuu");
                        
                        emptyWord = emptyWord.substring(0, i) + word.charAt(i) + emptyWord.substring(i + 1);
                        console.log(emptyWord.substring(0, i));
                        console.log(word.charAt(i));
                        console.log(emptyWord.substring(i + 1));
                    }
                }

                
                printout = emptyWord.split("").join(" ");
                console.log(emptyWord);
                
                document.getElementById("word").innerHTML = printout;
                document.getElementById("messages").innerHTML = "Good Guess!";
                guessedLetters += userChar;
                document.getElementById("miss").innerHTML = alphabet_order(guessedLetters);

                totalPoints += points;
                document.getElementById("points").innerHTML = totalPoints + " / 100";

                if(word == emptyWord){
                    document.getElementById("okButton").style.visibility = "hidden"; 
                    document.getElementById("guess").style.display = "none";
                    document.getElementById("messages").innerHTML = "You Win!";
                }

            } else {                
                console.log(word);
                console.log(typeof(word));
                console.log(userChar);
                console.log(typeof(userChar));
                console.log(emptyWord);
                document.getElementById("messages").innerHTML = "Bad Guess!";
                wrongGuesses += 1;
                drawing(wrongGuesses);
                guessedLetters += userChar;
                if(totalPoints >= 1){
                    totalPoints -= 1;
                } else if(totalPoints > 0){
                    totalPoints = 0;
                }
                document.getElementById("points").innerHTML = totalPoints + " / 100";
                document.getElementById("left").innerHTML = 7 - wrongGuesses;
                document.getElementById("miss").innerHTML = alphabet_order(guessedLetters);

                points -= 1;
            }

            
        }

        function alphabet_order(str)
            {
                return str.split('').sort().join('');
            }

        function drawing(wrongGuesses){
            if(wrongGuesses == 1){
                // hanger
                ctx.lineWidth = 7;
                ctx.moveTo(20, 260);
                ctx.lineTo(180, 260);
                ctx.moveTo(160, 260);
                ctx.lineTo(160, 50);
                ctx.lineTo(80, 50);
                ctx.lineTo(80, 60);
                ctx.stroke();
            }                
            
            if(wrongGuesses == 2){
                // head
                ctx.lineWidth = 3;
                ctx.beginPath();
                ctx.arc(80, 70, 10, 0, 2 * Math.PI);
                ctx.stroke(); 
            }                

            if(wrongGuesses == 3){
                // body
                ctx.moveTo(80, 80);
                ctx.lineTo(80, 140);
                ctx.stroke();
            }                

            if(wrongGuesses == 4){
                // right arm
                ctx.moveTo(80, 90);
                ctx.lineTo(50, 110);
                ctx.stroke();
            }                

            if(wrongGuesses == 5){
                // left arm
                ctx.moveTo(80, 90);
                ctx.lineTo(110, 110);
                ctx.stroke();
            }                

            if(wrongGuesses == 6){
                // right leg
                ctx.moveTo(80, 140);
                ctx.lineTo(50, 170);
                ctx.stroke();
            }                

            if(wrongGuesses == 7){
                // left leg
                ctx.moveTo(80, 140);
                ctx.lineTo(110, 170);
                ctx.stroke();

                if(totalPoints > 0){
                    totalPoints = totalPoints / 2;
                    document.getElementById("points").innerHTML = totalPoints + " / 100";
                }

                document.getElementById("okButton").style.visibility = "hidden"; 
                document.getElementById("guess").style.display = "none";
                document.getElementById("solution").style.visibility = "visible";
                document.getElementById("answer").style.visibility = "visible";
                document.getElementById("messages").innerHTML = "Game Over!";
            }                
        }  

        function solution(){
            document.getElementById("answer").innerHTML = word;
        }      
    </script>
</body>
</html>